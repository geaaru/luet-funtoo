image: "quay.io/mocaccino/extra"
env:
- LUET_YES=true
- LUET_NOLOCK=true
- HTTP_TIMEOUT=0
prelude:
- >-
  mkdir /mos-funtoo &&
  luet upgrade &&
  luet install repository/geaaru &&
  luet install system/luet-geaaru &&
  luet install --force --config ./luet.yaml
  repository/mocaccino-funtoo
  repository/luet
  repository/geaaru
  repository/mocaccino-extra-stable &&
  luet install --force --config ./luet.yaml --skip-finalizers
  system/luet-geaaru
  toolchain/base
  toolchain/boot
  toolchain/office
  toolchain/server
  toolchain/xorg-extra
  toolchain/browsers
  toolchain/emulation
  toolchain/calamares
  toolchain/meta-repo
  system/entities
  utils/yq &&
  luet cleanup --config ./luet.yaml &&
  mkdir -p /mos-funtoo/etc/luet &&
  yq w ./luet.yaml system.rootfs "/" -i &&
  cp ./luet.yaml /mos-funtoo/etc/luet/ &&
  cd /mos-funtoo/bin &&
  ln -s bash sh
