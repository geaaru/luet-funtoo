requires:
- category: "seed"
  name: "funtoo-kit-geaaru"
  version: ">=0"
env:
- JOBS=10
prelude:
- >-
  cp -rvf package.use /etc/portage/ &&
  epro mix-ins
  +kde-plasma-5
  +gfxcard-intel-classic
  +gfxcard-nouveau
  +gfxcard-nvidia
  +gfxcard-amdgpu
  +gfxcard-radeon
  +gfxcard-vmware
  +mediaformat-audio-extra
  +mediaformat-gfx-extra
  +mediaformat-video-extra
  +mediadevice-video-pro
  +vmware-guest &&
  emerge --unmerge x11-libs/amtk
- >-
  sed -i -e 's|2022.04.15|2022.04.26|g' /var/git/meta-repo/kits/media-kit/media-plugins/live/live-2022.04.15.ebuild &&
  mv /var/git/meta-repo/kits/media-kit/media-plugins/live/live-2022.04.15.ebuild /var/git/meta-repo/kits/media-kit/media-plugins/live/live-2022.04.26.ebuild &&
  ebuild /var/git/meta-repo/kits/media-kit/media-plugins/live/live-2022.04.26.ebuild digest
- >-
  export LUET_YES=true &&
  export LUET_NOLOCK=true &&
  export LUET_VERSION={{ ( index .Values.labels "luet_version" ) }} &&
  wget https://github.com/geaaru/luet/releases/download/v${LUET_VERSION}-geaaru/luet-v${LUET_VERSION}-geaaru-linux-amd64 -O /usr/bin/luet &&
  chmod a+x /usr/bin/luet &&
  luet upgrade --sync-repos  &&
  luet install repository/macaroni-commons  &&
  luet install --force --sync-repos
  macaroni/entities-catalog
  system/entities
  system/luet-geaaru &&
  luet cleanup --purge-repos &&
  entities merge -s /usr/share/macaroni/entities -a &&
  entities list users &&
  entities list groups

- >-
  FEATURES="-collision-protect -sandbox -usersandbox -ipc-sandbox -pid-sandbox -network-sandbox"
  emerge -t -j $JOBS -uDN @world &&
  rm -rf /var/cache/portage/distfiles/*
