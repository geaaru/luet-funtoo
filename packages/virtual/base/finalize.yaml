shell:
- "/bin/bash"
- "-c"
install:
- ldconfig
- if [ ! -e /bin/sh ] ; then cd /bin ; ln -s bash sh ; fi
- if [ ! -e /usr/bin/awk ] ; then cd /usr/bin ; ln -s gawk awk ; fi
- if [ ! -e /var/lib/portage ] ; then mkdir -p /var/lib/portage ; fi
- if [ ! -e /etc/portage/ ] ; then mkdir /etc/portage ; fi
- >-
  if [ ! -e /etc/portage/make.conf ] ; then
  export ARCH={{ ( index .Values.labels "gcc_arch" ) }} ;
  echo "CHOST=\"${ARCH}-pc-linux-gnu\"" > /etc/portage/make.conf ;
  fi
- if [ ! -e /etc/passwd ] ; then touch /etc/passwd ; fi
- if [ ! -e /etc/shadow ] ; then touch /etc/shadow ; fi
- if [ ! -e /etc/group ] ; then touch /etc/group ; fi
- if [ ! -e /etc/gshadow ] ; then touch /etc/gshadow ; fi
- if [ ! -e /etc/modules-load.d ] ; then mkdir /etc/modules-load.d ; fi
- chmod a+rx /var
- >-
  eval 'mkdir /tmp || true' &&
  chmod a+rwx /tmp
- ldconfig
